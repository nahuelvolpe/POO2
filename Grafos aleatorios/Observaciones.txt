Código funcional final con detalles a ultimar.